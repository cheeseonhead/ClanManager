//
//  ViewUserPresenterTests.swift
//  ClanManager
//
//  Created by Jeffrey Wu on 2017-01-13.
//  Copyright (c) 2017 Cheeseonhead. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so you can apply
//  clean architecture to your iOS and Mac projects, see http://clean-swift.com
//

@testable import ClanManager
import XCTest

class ViewUserPresenterTests: XCTestCase
{
    // MARK: - Subject under test

    var presenter: ViewUserPresenter!

    // MARK: - Test lifecycle

    override func setUp()
    {
        super.setUp()
        setupViewUserPresenter()
    }

    // MARK: - Test setup

    func setupViewUserPresenter()
    {
        presenter = ViewUserPresenter()
    }

    // MARK: - Tests

    func testPresentUserTriggersDisplayUser()
    {
        // Given
        let outputSpy = ViewUserPresenterOutputSpy()
        presenter.output = outputSpy

        // When
        presenter.presentUser(response: ViewUser.FetchUser.Response(firstName: "", lastName: "", townHallLevel: 0))

        // Then
        XCTAssertTrue(outputSpy.displayUserCalled, "Should trigger display user on the output")
    }

    func testPresenterSendsCorrectViewModel
    {
        // Given
        let outputSpy = ViewUserPresenterOutputSpy()
        let response = ViewUser.FetchUser.Response(firstName: "John", lastName: "Doe", townHallLevel: 4)
        presenter.output = outputSpy

        // When
        presenter.presentUser(response: response)

        // Then
        let result = outputSpy.viewUser_fetchUser_viewModel
        XCTAssertEqual(result.name, "John Doe")
        XCTAssertEqual(result.info, "Town Hall Level 4")
    }
}

fileprivate class ViewUserPresenterOutputSpy: ViewUserPresenterOutput
{
    var displayUserCalled = false
    var viewUser_fetchUser_viewModel: ViewUser.FetchUser.ViewModel

    func displayUser(viewModel viewModel: ViewUser.FetchUser.ViewModel)
    {
        displayUserCalled = true
        viewUser_fetchUser_viewModel = viewModel
    }
}
